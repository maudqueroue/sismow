---
title: "Population Abundance Emulator"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Population Abundance Emulator}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(sismow)
```

<!-- This vignette is generated by fusen: do not edit by hand -->

<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.
-->


## Simulate density map

This function allows to simulate different densities in the studied area:         

- A **homogenous** density with the same density througout the studied aera.    
- A **gradient** density with a density decreasing from a hotspot that could be placed on different direction: `N` for North, `NE` for North-East, `E` for East, `SE` for South-East, `S` for South, `SW` for South-West, `W` for West, `NW` for North-West and `C` for center). The amplitude and the wavelength of the hotspot created can be modified.    
- A **random** density, created by adding a certain number of hotspots on the study area. The hotspot created have a maximum amplitude and a maximum wavelength` that can be modified. Each hotspot created have an amplitude and a wavelength randomly chosen between 1 and a maximum amplitude and a maximum wavelength that can be modified by the user.     

The output is a map in sf dataframe contaning the simulated density. The dataframe contains two columns:    
- `density` : simulated for each square of the grid    
- `geometry` 


### Examples

For this example, `shape_courseulles`, a dataframe included in this package is used. With `simulate_density` some density maps are simulated:      
- (1) a **gradient** density map with a hotspot of density in the North. 
- (2) a **random** density map with 10 random hotspots   


```{r examples-simulate_density}

library(ggplot2)
data("shape_courseulles")

# ------------------------------
# Example 1 : Simulate a map with a gradient density from the North

map <- simulate_density(shape_obj = shape_courseulles,
                              density_type = "gradient",
                              gradient_direction = "N",
                              wavelength = 40000,
                              amplitude = 15)

# Plot
ggplot() +
  geom_sf(data = map, aes(fill = density))


# ------------------------------
# Example 2 : Simulate a map with a random density

map <- simulate_density(shape_obj = shape_courseulles,
                              density_type = "random",
                              wavelength = 10000,
                              amplitude = 15,
                              nb_hotspots = 10
                              
)

# Plot 
ggplot() +
  geom_sf(data = map, aes(fill = density))

```

## Simulate individuals

This function allows to simulate a approximate number of individuals with a inhomogenous Poisson point process according to the densities provided.

From an sf class density map `map_obj`, an inohomogene Poisson point process is used to simulate the presence of `N` individuals in the study area. The probability of presence of an individual is dependent on the density given by the map. 

The output is the simulated individuals in a dataframe. The dataframe contains three columns:    
-`x` : longitude of the simulated individual. 
-`y` : latitude of the simulated individual. 
- `size` : the number of individuals simulated on the location (the possibility of simulate groupe will comming).


### Example

An example of this function use a dataset `dataset_map` consisting in a dataframe of class `sf` containing density information. 

From this map, the aim of the function `simulate_ind` is to simulate the presence of individuals in the study area. The function return a dataframe, here `ind`, containing the differents individuals simulated and their geographic coordinates. 


```{r examples-simulate_ind, warning = FALSE}

library(ggplot2)
data("shape_courseulles")

# First, create a map with a gradient density from the North with 500 individuals in the area
map <- simulate_density(shape_obj = shape_courseulles,
                              grid_size = 1000,
                              density_type = "gradient",
                              gradient_direction = "N",
                              wavelength = 20000,
                              amplitude = 100)

# Then simulate the presence of individuals in the study area 
ind <- simulate_ind(map_obj = map, N = 200)

# Plot
ggplot() +
    geom_sf(data = map, aes(fill = density)) +
    geom_point(data = ind, aes(x = x, y = y))
  
```

